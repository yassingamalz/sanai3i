<!-- Header Section -->
<header class="bg-[#ef4444]">
  <div class="px-4 pt-8 pb-3">
    <div class="bg-white rounded-full flex items-center h-11 shadow-sm">
      <span class="flex-1 text-gray-700 text-sm mr-4 text-right">
        <i class="fas fa-search text-gray-400 ml-2"></i>
        البحث عن خدمة
      </span>
      <div class="flex items-center ml-4">
        <i class="fas fa-home text-[#ef4444] text-lg"></i>
        <span class="text-[#ef4444] mr-2 font-medium">الرئيسية</span>
      </div>
    </div>
  </div>
</header>

<app-featured-slider></app-featured-slider>
<!-- All Services Section -->
<section class="content-section">
  <div class="section-header">
    <div class="header-content">
      <h2 class="section-title">كل الخدمات</h2>
      <div class="header-icons" (click)="navigateToFullList('all-services')">
        <i class="fas fa-chevron-left"></i>
      </div>
    </div>
  </div>
  <div class="services-grid">
    <!-- Loading State -->
    <ng-container *ngIf="isLoading">
      <div class="skeleton-grid-card" *ngFor="let item of [1,2,3,4,5,6]">
        <div class="skeleton-icon shimmer"></div>
        <div class="skeleton-text shimmer w-2/3 mx-auto"></div>
        <div class="skeleton-text shimmer w-3/4 mx-auto"></div>
      </div>
    </ng-container>
    
    <!-- Loaded State with Animation -->
    <ng-container *ngIf="!isLoading">
      <div *ngFor="let service of services; let i = index; trackBy: trackByServiceId" 
           #serviceCard
           class="grid-card"
           (click)="openService(service.id)"
           [@fadeInUp]="shouldAnimate(i) ? 'in' : 'void'">
        <div class="service-icon">{{service.icon}}</div>
        <h3 class="card-title">{{service.name}}</h3>
        <p class="card-subtitle">{{service.description}}</p>
      </div>
    </ng-container>
  </div>
</section>

<!-- Top Workers Section -->
<section class="content-section">
  <div class="section-header">
    <div class="header-content">
      <h2 class="section-title">أفضل الصنايعية</h2>
      <div class="header-icons">
        <i class="fas fa-chevron-left"></i>
      </div>
    </div>
  </div>
  <div class="cards-container">
    <!-- Loading State -->
    <ng-container *ngIf="isLoading">
      <div class="worker-card" *ngFor="let item of [1,2,3]">
        <div class="skeleton-circle shimmer"></div>
        <div class="flex-1">
          <div class="skeleton-text shimmer w-2/3"></div>
          <div class="skeleton-text shimmer w-1/2"></div>
          <div class="skeleton-text shimmer w-1/3"></div>
        </div>
      </div>
    </ng-container>

    <!-- Loaded State -->
    <ng-container *ngIf="!isLoading">
      <div *ngFor="let worker of topWorkers; trackBy: trackByWorkerId" class="worker-card"
        (click)="onWorkerClick(worker)">
        <img [src]="worker.image" [alt]="worker.name" class="worker-image" />
        <div class="worker-info">
          <h3 class="card-title">{{worker.name}}</h3>
          <p class="card-subtitle">{{worker.service}}</p>
          <div class="rating">
            <i class="fas fa-star"></i>
            <span>{{worker.rating}} • {{worker.completedJobs}} خدمة</span>
          </div>
        </div>
        <i class="fas fa-chevron-right arrow-icon"></i>
      </div>
    </ng-container>
  </div>
</section>

<!-- Top Services Section -->
<section class="content-section">
  <div class="section-header">
    <div class="header-content">
      <div class="header-title">
        <h2 class="section-title">الخدمات الأكثر طلباً</h2>
        <span class="request-count" *ngIf="!isLoading">{{topServices[0]!.totalRequests || 0}} طلب</span>
      </div>
      <div class="header-icons">
        <i class="fas fa-chevron-left"></i>
      </div>
    </div>
  </div>
  <div class="cards-container">
    <!-- Loading State -->
    <ng-container *ngIf="isLoading">
      <div class="skeleton-card" *ngFor="let item of [1,2,3]">
        <div class="flex justify-between">
          <div class="skeleton-text shimmer w-1/4"></div>
          <div class="skeleton-text shimmer w-1/3"></div>
        </div>
      </div>
    </ng-container>

    <!-- Loaded State -->
    <ng-container *ngIf="!isLoading">
      <div *ngFor="let service of topServices; trackBy: trackByServiceId" class="service-card">
        <div class="service-content">
          <div class="service-info">
            <h3 class="card-title">{{service.name}}</h3>
            <span class="request-count">{{service.totalRequests}} طلب</span>
          </div>
          <div class="trend-container">
            <i class="fa-solid" [class.fa-arrow-trend-up]="service.trend === 'up'"
              [class.fa-arrow-trend-down]="service.trend === 'down'" [class.text-success]="service.trend === 'up'"
              [class.text-danger]="service.trend === 'down'">
            </i>
            <span class="trend-value" [class.text-success]="service.trend === 'up'"
              [class.text-danger]="service.trend === 'down'">
              {{service.trendValue}}%
            </span>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</section>