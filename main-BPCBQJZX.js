import{a as ue}from"./chunk-JAFVUNED.js";import{a as P}from"./chunk-QWLYJROW.js";import{$ as d,A as y,Aa as ae,Ba as ce,C as M,Ca as L,D as p,Da as O,Ea as pe,F as te,Fa as h,M as re,P as z,S as C,T as w,V as ne,Y as E,Z as _,_ as s,a as H,aa as a,e as Y,ea as x,h as D,i as $,j as l,k as q,l as W,ma as S,n as B,o as V,p as v,pa as ie,q as b,qa as oe,r as m,ra as se,s as J,t as Q,u as I,v as X,x as T,y as c,ya as F,z as ee,za as K}from"./chunk-XOYOS3WC.js";var Se=()=>["/"],Oe=()=>["/discover"],Pe=()=>["/services"],Ae=()=>["/messages"],ke=()=>["/profile"],me=(()=>{class e{constructor(t,r){this.router=t,this.authService=r}get currentRoute(){return this.router.url.split("/")[1]||"home"}get userType(){return this.authService.getCurrentUser()?.type||"customer"}get servicesLabel(){return this.userType==="worker"?"\u062E\u062F\u0645\u0627\u062A\u064A":"\u0637\u0644\u0628\u0627\u062A\u064A"}static{this.\u0275fac=function(r){return new(r||e)(w(O),w(P))}}static{this.\u0275cmp=M({type:e,selectors:[["app-nav-bar"]],decls:21,vars:18,consts:[[1,"nav-container"],[1,"nav-grid"],[1,"nav-item",3,"routerLink"],[1,"fas","fa-home"],[1,"fas","fa-compass"],[1,"center-button"],[1,"floating-button",3,"routerLink"],[1,"fas","fa-list"],[1,"fas","fa-envelope"],[1,"fas","fa-user"]],template:function(r,n){r&1&&(s(0,"nav",0)(1,"div",1)(2,"a",2),a(3,"i",3),s(4,"span"),x(5,"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629"),d()(),s(6,"a",2),a(7,"i",4),s(8,"span"),x(9,"\u0627\u0643\u062A\u0634\u0641"),d()(),s(10,"div",5)(11,"a",6),a(12,"i",7),d()(),s(13,"a",2),a(14,"i",8),s(15,"span"),x(16,"\u0627\u0644\u0631\u0633\u0627\u0626\u0644"),d()(),s(17,"a",2),a(18,"i",9),s(19,"span"),x(20,"\u062D\u0633\u0627\u0628\u064A"),d()()()()),r&2&&(C(2),_("active",n.currentRoute===""),E("routerLink",S(13,Se)),C(4),_("active",n.currentRoute==="discover"),E("routerLink",S(14,Oe)),C(5),E("routerLink",S(15,Pe)),C(2),_("active",n.currentRoute==="favorites"),E("routerLink",S(16,Ae)),C(4),_("active",n.currentRoute==="profile"),E("routerLink",S(17,ke)))},dependencies:[pe],styles:["[_nghost-%COMP%]{display:block;padding-bottom:env(safe-area-inset-bottom)}.nav-container[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;left:0;background-color:#fff;border-top:1px solid #e5e7eb;width:100%;z-index:50;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.nav-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);width:100%;padding:.75rem 0;gap:0}.nav-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-decoration:none;color:#9ca3af;width:100%;transition:color .2s ease}.nav-item.active[_ngcontent-%COMP%]{color:#ef4444}.nav-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.25rem;margin-bottom:.25rem}.nav-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.center-button[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;display:flex;justify-content:center}.center-button[_ngcontent-%COMP%]   .floating-button[_ngcontent-%COMP%]{position:absolute;bottom:100%;width:3.5rem;height:3.5rem;background-color:#ef4444;border-radius:9999px;display:flex;align-items:center;justify-content:center;color:#fff;transform:translateY(50%);box-shadow:0 4px 6px -1px #0000001a;border:4px solid white;transition:transform .2s ease}.center-button[_ngcontent-%COMP%]   .floating-button[_ngcontent-%COMP%]:hover{transform:translateY(45%)}.center-button[_ngcontent-%COMP%]   .floating-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem}"]})}}return e})();var de=(()=>{class e{constructor(t,r){this.router=t,this.authService=r}get currentRoute(){return this.router.url.split("/")[1]||"home"}get userType(){return this.authService.getCurrentUser()?.type||"customer"}get servicesLabel(){return this.userType==="worker"?"\u062E\u062F\u0645\u0627\u062A\u064A":"\u0637\u0644\u0628\u0627\u062A\u064A"}static{this.\u0275fac=function(r){return new(r||e)(w(O),w(P))}}static{this.\u0275cmp=M({type:e,selectors:[["app-main-layout"]],decls:4,vars:0,consts:[["dir","rtl",1,"app-container"],[1,"pb-20"]],template:function(r,n){r&1&&(s(0,"div",0)(1,"main",1),a(2,"router-outlet"),d(),a(3,"app-nav-bar"),d())},dependencies:[L,me],styles:["[_nghost-%COMP%]{display:block;min-height:100vh}main[_ngcontent-%COMP%]{min-height:calc(100vh - 136px)}.active-link[_ngcontent-%COMP%]{color:#ef4444}.custom-title[_ngcontent-%COMP%]{font-family:Changa,Marhey,Ruwudu,sans-serif;font-size:2em}"]})}}return e})();var A=(()=>{class e{constructor(t,r){this.authService=t,this.router=r}canActivate(t,r){return this.authService.currentUser$.pipe(m(1),l(n=>{let u=r.url;return n?t.data?.roles&&!t.data.roles.includes(n.type)?this.router.createUrlTree(["/"]):!0:(localStorage.setItem("returnUrl",u),this.router.createUrlTree(["/auth/welcome"]))}))}canActivateChild(t,r){return this.canActivate(t,r)}static{this.\u0275fac=function(r){return new(r||e)(y(P),y(O))}}static{this.\u0275prov=T({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Te=[{path:"",component:de,children:[{path:"",loadChildren:()=>import("./chunk-S4LCUVQR.js").then(e=>e.HomeModule),canActivate:[A]},{path:"profile",loadChildren:()=>import("./chunk-TACSJ3DD.js").then(e=>e.ProfileModule),canActivate:[A]},{path:"services",loadChildren:()=>import("./chunk-BQKRGMFD.js").then(e=>e.ServicesModule),canActivate:[A]},{path:"messages",loadChildren:()=>import("./chunk-XYBIHX6R.js").then(e=>e.MessagesModule),canActivate:[A]},{path:"discover",loadChildren:()=>import("./chunk-3FV7XUGL.js").then(e=>e.DiscoverModule),canActivate:[A]}]},{path:"auth",loadChildren:()=>import("./chunk-VBSNLWTR.js").then(e=>e.AuthModule)}],fe=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=p({type:e})}static{this.\u0275inj=c({imports:[h.forRoot(Te),h]})}}return e})();var he=(()=>{class e{constructor(){this.title="sanai3i"}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=M({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(r,n){r&1&&a(0,"router-outlet")},dependencies:[L]})}}return e})();var U=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=p({type:e})}static{this.\u0275inj=c({imports:[F,h]})}}return e})();var ge=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=p({type:e})}static{this.\u0275inj=c({imports:[F,h,U]})}}return e})();var N="Service workers are disabled or not supported by this browser";function _e(e){return W(()=>$(new Error(e)))}var k=class{constructor(i){if(this.serviceWorker=i,!i)this.worker=this.events=this.registration=_e(N);else{let r=B(i,"controllerchange").pipe(l(()=>i.controller)),n=W(()=>D(i.controller)),u=q(n,r);this.worker=u.pipe(b(g=>!!g)),this.registration=this.worker.pipe(I(()=>i.getRegistration()));let G=B(i,"message").pipe(l(g=>g.data)).pipe(b(g=>g&&g.type)).pipe(Q());G.connect(),this.events=G}}postMessage(i,t){return this.worker.pipe(m(1),X(r=>{r.postMessage(H({action:i},t))})).toPromise().then(()=>{})}postMessageWithOperation(i,t,r){let n=this.waitForOperationCompleted(r),u=this.postMessage(i,t);return Promise.all([u,n]).then(([,o])=>o)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(i){let t;return typeof i=="string"?t=r=>r.type===i:t=r=>i.includes(r.type),this.events.pipe(b(t))}nextEventOfType(i){return this.eventsOfType(i).pipe(m(1))}waitForOperationCompleted(i){return this.eventsOfType("OPERATION_COMPLETED").pipe(b(t=>t.nonce===i),m(1),l(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},Me=(()=>{class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new Y,!t.isEnabled){this.messages=v,this.notificationClicks=v,this.subscription=v;return}this.messages=this.sw.eventsOfType("PUSH").pipe(l(n=>n.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(l(n=>n.data)),this.pushManager=this.sw.registration.pipe(l(n=>n.pushManager));let r=this.pushManager.pipe(I(n=>n.getSubscription()));this.subscription=V(r,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(N));let r={userVisibleOnly:!0},n=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),u=new Uint8Array(new ArrayBuffer(n.length));for(let o=0;o<n.length;o++)u[o]=n.charCodeAt(o);return r.applicationServerKey=u,this.pushManager.pipe(I(o=>o.subscribe(r)),m(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(N));let t=r=>{if(r===null)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(n=>{if(!n)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(m(1),I(t)).toPromise()}decodeBase64(t){return atob(t)}static{this.\u0275fac=function(r){return new(r||e)(y(k))}}static{this.\u0275prov=T({token:e,factory:e.\u0275fac})}}return e})(),Ce=(()=>{class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=v,this.unrecoverable=v;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(N));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(N));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static{this.\u0275fac=function(r){return new(r||e)(y(k))}}static{this.\u0275prov=T({token:e,factory:e.\u0275fac})}}return e})();var ve=new ee("");function xe(e,i,t,r){return()=>{if(!(K(r)&&"serviceWorker"in navigator&&t.enabled!==!1))return;navigator.serviceWorker.addEventListener("controllerchange",()=>{navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})});let n;if(typeof t.registrationStrategy=="function")n=t.registrationStrategy();else{let[o,...j]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(o){case"registerImmediately":n=D(null);break;case"registerWithDelay":n=be(+j[0]||0);break;case"registerWhenStable":n=j[0]?V(ye(e),be(+j[0])):ye(e);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}e.get(ne).runOutsideAngular(()=>n.pipe(m(1)).subscribe(()=>navigator.serviceWorker.register(i,{scope:t.scope}).catch(o=>console.error("Service worker registration failed with:",o))))}}function be(e){return D(null).pipe(J(e))}function ye(e){return e.get(oe).isStable.pipe(b(t=>t))}function Re(e,i){return new k(K(i)&&e.enabled!==!1?navigator.serviceWorker:void 0)}var R=class{};function Ne(e,i={}){return te([Me,Ce,{provide:ve,useValue:e},{provide:R,useValue:i},{provide:k,useFactory:Re,deps:[R,z]},{provide:ie,useFactory:xe,deps:[re,ve,R,z],multi:!0}])}var we=(()=>{class e{static register(t,r={}){return{ngModule:e,providers:[Ne(t,r)]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=p({type:e})}static{this.\u0275inj=c({providers:[Me,Ce]})}}return e})();var Ee=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=p({type:e,bootstrap:[he]})}static{this.\u0275inj=c({imports:[ce,ge,U,fe,ue,we.register("ngsw-worker.js",{enabled:!se(),registrationStrategy:"registerWhenStable:30000"})]})}}return e})();ae().bootstrapModule(Ee).catch(e=>console.error(e));
